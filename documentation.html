<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Spring Crypto Utils - Documentation</title>
    <link href="assets/css/bootstrap.min.css" type="text/css" rel="stylesheet">
    <link href="assets/css/docs.css" type="text/css" rel="stylesheet">
    <link href="assets/css/prettify.css" type="text/css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 60px;
            padding-bottom: 40px;
        }
    </style>
    <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=PT+Mono" rel="stylesheet" type="text/css">
    <link rel="shortcut icon" href="img/favicon.ico">
</head>

<body data-spy="scroll" data-target=".subnav" data-offset="50">

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse"
               data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="index.html">Spring Crypto Utils</a>

            <div class="nav-collapse">
                <ul class="nav">
                    <li><a href="index.html">Home</a></li>
                    <li class="active"><a
                            href="documentation.html">Documentation</a></li>
                    <li><a href="documentation.html#changelog">ChangeLog</a></li>
                    <li><a href="documentation.html#roadmap">RoadMap</a></li>
                    <li><a href="https://github.com/mcaserta/spring-crypto-utils">GitHub</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="container">

<header class="jumbotron subhead" id="overview">
    <h1>Documentation</h1>

    <p class="lead">

    <div class="subnav">
        <ul class="nav nav-pills">
            <li><a href="#foreword">Foreword</a></li>
            <li><a href="#setup">Setup</a></li>
            <li><a href="#keystore">Keystore</a></li>
            <li><a href="#keys">Key</a></li>
            <li><a href="#signatureSingle">Sign-S</a></li>
            <li><a href="#signatureMulti">Sign-M</a></li>
            <li><a href="#symmetric">Symm</a></li>
            <li><a href="#asymmetric">Asymm</a></li>
            <li><a href="#digest">Digest</a></li>
            <li><a href="#messageAuthenticationCodes">Mac</a></li>
        </ul>
    </div>
</header>

<section id="foreword">
    <div class="page-header">
        <h1>Foreword
            <small>Before getting started</small>
        </h1>
    </div>
    <div class="row">
        <div class="span3 columns">
            <h3>Foreword</h3>
        </div>
        <div class="span9 columns">
            <h2>What's a public key?</h2>

            <p>If you are asking questions such as this, go get yourself a copy of <a target="_blank"
                    href="http://www.schneier.com/book-applied.html">Bruce Schneier's Applied Cryptography</a>.
                Seriously, he told you so:</p>

            <p><a target="_blank" href="http://www.schneier.com/book-applied.html"><img
                    src="img/applied-cryptography.jpg" width="500" height="374"></a></p>

            <p>Fun fact: <a target="_blank" href="http://www.schneierfacts.com/fact/18">Bruce Schneier knows Alice
                and Bob's shared secret</a>.</p>
        </div>
    </div>
</section>

<section id="setup">
    <div class="page-header">
        <h1>Setup
            <small>Getting started</small>
        </h1>
    </div>
    <div class="row">
        <div class="span3 columns">
            <h3>About setup</h3>

            <p>Your setup will depend on whether or not you use maven. Also, if you're going to use the xml
                configuration, there's a bit of xml namespace setup to do.</p>
        </div>
        <div class="span9 columns">
            <h2>With maven</h2>

            <p>Add the following dependency block to your pom:</p>

                <pre class="prettyprint">
&lt;dependency&gt;
    &lt;groupId&gt;com.google.code.spring-crypto-utils&lt;/groupId&gt;
    &lt;artifactId&gt;spring-crypto-utils&lt;/artifactId&gt;
    &lt;version&gt;1.1.1&lt;/version&gt;
&lt;/dependency&gt;</pre>

            <div class="alert alert-info">
                <h4 class="alert-heading">Maven Central Ready</h4>
                Spring Crypto Utils is in <a
                    href="http://repo1.maven.org/maven2/com/google/code/spring-crypto-utils/spring-crypto-utils/"
                    target="_blank">maven central</a>, so there's no extra repository to setup in the pom. If you
                had previously setup our custom repository, you can safely remove it from your poms now as all
                publicily released versions have been (and will be) uploaded to central.
            </div>

            <h2>Without maven</h2>

            <p>Download the latest jar from the download page and put the file in the classpath of your
                application.</p>

            <p>The following jars are also needed:</p>

            <ul>
                <li>Apache Commons
                    <ul>
                        <li>commons-logging:commons-logging:jar:1.1.1
                            <a href="http://repo1.maven.org/maven2/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar"><span
                                    class="label label-info">download</span></a></li>
                        <li>commons-codec:commons-codec:jar:1.6
                            <a href="http://repo1.maven.org/maven2/commons-codec/commons-codec/1.6/commons-codec-1.6.jar"><span
                                    class="label label-info">download</span></a></li>
                    </ul>
                </li>
                <li>Spring Framework
                    <ul>
                        <li>org.springframework:spring-context:jar:3.1.0.RELEASE
                            <a href="http://repo1.maven.org/maven2/org/springframework/spring-context/3.1.0.RELEASE/spring-context-3.1.0.RELEASE.jar"><span
                                    class="label label-info">download</span></a></li>
                        <li>org.springframework:spring-beans:jar:3.1.0.RELEASE
                            <a href="http://repo1.maven.org/maven2/org/springframework/spring-beans/3.1.0.RELEASE/spring-beans-3.1.0.RELEASE.jar"><span
                                    class="label label-info">download</span></a></li>
                        <li>org.springframework:spring-core:jar:3.1.0.RELEASE
                            <a href="http://repo1.maven.org/maven2/org/springframework/spring-core/3.1.0.RELEASE/spring-core-3.1.0.RELEASE.jar"><span
                                    class="label label-info">download</span></a></li>
                        <li>org.springframework:spring-expression:jar:3.1.0.RELEASE
                            <a href="http://repo1.maven.org/maven2/org/springframework/spring-expression/3.1.0.RELEASE/spring-expression-3.1.0.RELEASE.jar"><span
                                    class="label label-info">download</span></a></li>
                        <li>org.springframework:spring-asm:jar:3.1.0.RELEASE
                            <a href="http://repo1.maven.org/maven2/org/springframework/spring-asm/3.1.0.RELEASE/spring-asm-3.1.0.RELEASE.jar"><span
                                    class="label label-info">download</span></a></li>
                    </ul>
                </li>
            </ul>

            <h2>Xml Namespace</h2>

            <p>If you want to use the xml in configuring the framework, you will need to declare the crypt namespace
                in your spring context xml configuration files, like this:</p>

                <pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    <strong>xmlns:crypt="http://code.google.com/p/spring-crypto-utils/schema/crypt"</strong>
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        <strong>http://code.google.com/p/spring-crypto-utils/schema/crypt
        http://code.google.com/p/spring-crypto-utils/schema/crypt.xsd</strong>"&gt;

&lt;/beans&gt;</pre>

            <p>This gets you full autocompletion support in an xsd aware editor such as Intellij Idea.</p>
        </div>
    </div>
</section>

<section id="keystore">
    <div class="page-header">
        <h1>Keystore
            <small>Keep your keys handy</small>
        </h1>
    </div>
    <div class="row">
        <div class="span3 columns">
            <h3>About keystores</h3>

            <p>Most cryptographic operations require keys. Keys are usually best kept in a keystore file.</p>

            <p>To manipulate keystore files, we suggest the excellent, cross platform and free <a
                    href="http://www.lazgosoftware.com/kse/index.html" target="_blank">Keystore Explorer</a>.</p>
        </div>
        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#keystore-simple" data-toggle="tab">keystore</a></li>
                <li><a href="#keystore-default" data-toggle="tab">defaultKeystore</a></li>
                <li><a href="#keystore-b64" data-toggle="tab">b64Keystore</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="keystore-simple">
                    <p>To get a reference to a keystore, use the <code>&lt;crypt:keystore&gt;</code> element:</p>

                    <pre class="prettyprint">&lt;crypt:keystore id="fooKeystore" location="classpath:keystore-foo.jks"
    password="password" type="JKS"/&gt;</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">type</h4>
                        The <code>type</code> attribute is optional: <code>JKS</code> is the default keystore type if no
                        <code>type</code> attribute is specified.
                    </div>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">location</h4>
                        The <code>location</code> attribute follows the spring resources conventions (see table
                        5.1 in the <a
                            href="http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/resources.html#resources-resourceloader"
                            target="_blank">spring reference documentation</a> for an overview)
                    </div>
                </div>
                <div class="tab-pane" id="keystore-default">
                    <p><span class="label">Since 1.0.1</span></p>

                    <p>If you prefer to configure the keystore by defining the java system properties
                        <code>javax.net.ssl.keyStore</code> and <code>javax.net.ssl.keyStorePassword</code>, you can get
                        a reference to the
                        keystore simply with:</p>

                    <pre class="prettyprint">&lt;crypt:defaultKeystore id="defaultKeystore"/&gt;</pre>

                </div>
                <div class="tab-pane" id="keystore-b64">
                    <p>A keystore can also be embedded in the xml config file itself using the base64 encoding:</p>
<pre class="prettyprint">&lt;crypt:b64Keystore id="keystore" password="password" type="JKS"&gt;
    &lt;crypt:file&gt;
        /u3+7QAAAAIAAAABAAAAAQAEdGVzdAAAASazcnA7AAACvTCCArkwDgYKKwYBBAEq
        AhEBAQUABIICpXWgVfoBjEXhW7TUr4i8npIcnRfWKy8i5Mly28DaiNQIcbUmqVol
        hfjbmoz930cT+puKpVmt+Rv28MEWEHDH3JFixM7aQgjmMsXL4z0AE/cgW0bn5C3P
        LBrvG3Ieq0Kj1ZebLuBtHM92LwrkctTq3dvy6sCQHLtpefInmdjqfAbJnls/y2RX
        PoNwwwu6yIWw6GnXQ41TjhIOcXhmog4e7aH+2Ch+6vFsnNf0hHDdGI/PPvGnIvf9
        kGb1a9894sy1xApi1oV/OzH3ZZ8WKlXZmycke3QtVfREFRv22400tayoFyQzCbNE
        jNpzExRhHd5W1fEaVBXIjw73eB8l31XgIQlBFnUBkBXkQ56nYPRL6ODPNIYEYJSE
        XJnN8POgc+TFEisP4MK4fzr7pb5iVBokbWMS6ixCayaUSksn/U8mtAQSSy3Wx8KS
        0S+HvHCv7g8qflLuQD3TC7dBF4ai8O7U4TXljqugW53UzmcSHbY+3js2R3SYdOxI
        1CZ+Ly59WYHsAwtVhor1QFqmx1GwI/OJFy5cdd0Kcn2IKcQwEuTZcNEL7ZzBSrKQ
        WQ/Vysn2rHr/iWZBg7H/8Ybk3yBoPvn9xi6IFOV74a9EPn3eb8h4yF6yFLieIKXo
        2pM1BFmvkbQYcg8HhWWb8ppJC5He2j6LCmhMBciVY5ltSXe8siyPqGi1uSNeqduv
        O+JGfCgpcAezpGL2KFCbcHyISPlhDERKWdI560OR8ytQXmX996OcM34aRl0D+cgL
        hblZOzXCv9bj9ePWMTytF/YeVebsjU4clxLWnGBU9hbkvdBTf8q795DAcbqnL6QC
        mo+1wq8OZTxRcF2Er97A3QCSrvK5hWrG2rkUcw55TSPeoaobj6YgYOnv1dpuHCXs
        6J8V/b4FGCDn2XAcgEUOAAAAAQAFWC41MDkAAAI5MIICNTCCAZ6gAwIBAgIES3GF
        tjANBgkqhkiG9w0BAQUFADBfMQswCQYDVQQGEwJJVDELMAkGA1UECBMCUk0xDTAL
        BgNVBAcTBFJvbWUxDTALBgNVBAoTBE5vbmUxDTALBgNVBAsTBE5vbmUxFjAUBgNV
        BAMTDU1pcmtvIENhc2VydGEwHhcNMTAwMjA5MTU1NjM4WhcNMTAwNTEwMTU1NjM4
        WjBfMQswCQYDVQQGEwJJVDELMAkGA1UECBMCUk0xDTALBgNVBAcTBFJvbWUxDTAL
        BgNVBAoTBE5vbmUxDTALBgNVBAsTBE5vbmUxFjAUBgNVBAMTDU1pcmtvIENhc2Vy
        dGEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAKjtmUJ2Y06oi/e90tgfvNLt
        TadWre36dsKvhrhxaXtcGC54cjaN/r2iAlLnTrqJN9K7cWYHI5Rh1bYZzOSGY2PX
        6DoLis5OsDzP/9rXZRMVfNynLsjTeIkG579qht6j6JAtyvHIdH5hrDjE32xx/X78
        iLTYMAuXb+Uo8VNZTft7AgMBAAEwDQYJKoZIhvcNAQEFBQADgYEApXFvvASzzw4G
        VmbJB1os/PnKAD82WpDDP6pjDOE4ALAzJoP71uqvLffr4qRBmMOMX6IGmLBckYRS
        axQ8OCU6QBU4RU1cY/xxrXgfKditL8SAY4Ll07uwoilBJqxM9clT0AtYwxTgS5KF
        7bw6Q7mk5Ki1d9hpmBBn+HGB9+MCqTCz/VETRUu45lQPtwUuwvOmff2WHg==
    &lt;/crypt:file&gt;
&lt;/crypt:b64Keystore&gt;</pre>

                    <p>The Base64 block above was generated with:</p>

                    <pre class="prettyprint lang-sh">$ openssl enc -base64 -in keystore.jks</pre>
                </div>
            </div>

            <script>
                $(function () {
                    $('.tabs a:last').tab('show')
                })
            </script>
        </div>
    </div>
</section>

<section id="keys">
    <div class="page-header">
        <h1>Keys
            <small>Private, public and secret</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Keys</h3>

            <p>Once you have setup a keystore, it's time to use those keys.</p>
        </div>

        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#key-private" data-toggle="tab">privateKey</a></li>
                <li><a href="#key-public" data-toggle="tab">publicKey</a></li>
                <li><a href="#key-secret" data-toggle="tab">secretKey</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="key-private">
<pre class="prettyprint"><strong>&lt;crypt:privateKey id="privateKey" keystore-ref="keystore" alias="test"
    password="password"/&gt;</strong>

&lt;crypt:keystore id="keystore" location="classpath:keystore.jks"
    password="password"/&gt;</pre>
                </div>

                <div class="tab-pane" id="key-public">
<pre class="prettyprint"><strong>&lt;crypt:publicKey id="publicKey" keystore-ref="keystore" alias="test"/&gt;</strong>

&lt;crypt:keystore id="keystore" location="classpath:keystore.jks" password="password"/&gt;</pre>
                </div>

                <div class="tab-pane" id="key-secret">
<pre class="prettyprint"><strong>&lt;crypt:secretKey id="secretKey" keystore-ref="keystore" alias="hmac"
    password="changeit"/&gt;</strong>

&lt;crypt:keystore id="keystore" location="classpath:keystore.jceks"
    password="changeit" type="JCEKS"/&gt;</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">JCEKS keystores</h4>
                        Please note that in order to use secret keys, you will need to employ a keystore in JCEKS
                        format.
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="signatureSingle">
    <div class="page-header">
        <h1>Signature
            <small>with Single Keys</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Digital Signatures with Single Keys</h3>

            <p>In order to sign a document you'll need a private key. To verify a signature you'll need the public key
                that was extracted from the private key used to generate the signature.</p>

            <p>There are base64 versions of all signers and verifiers so you won't have to worry about encoding when
                exchanging data over a network.</p>
        </div>

        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#signer" data-toggle="tab">signer</a></li>
                <li><a href="#b64Signer" data-toggle="tab">b64Signer</a></li>
                <li><a href="#verifier" data-toggle="tab">verifier</a></li>
                <li><a href="#b64Verifier" data-toggle="tab">b64Verifier</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="signer">
                    <p>A simple signer is useful when you need to sign something with a single private key.</p>

<pre class="prettyprint"><strong>&lt;crypt:signer id="signer" privateKey-ref="privateKey"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;crypt:privateKey id="privateKey" keystore-ref="keystore" alias="test"
    password="password"/&gt;

&lt;crypt:keystore id="keystore" location="classpath:keystore.jks"
    password="password"/&gt;
</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">algorithm</h4>
                        <code>SHA1withRSA</code> is the default algorithm and can be omitted.
                    </div>

                    <p>The signer can then be used like this:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.Signer;</strong>

public class MyPaymentSigner {

    <strong>@Autowired
    private Signer signer;</strong>

    public byte[] signPayment(byte[] payment) {
        <strong>byte[] signature = signer.sign(payment);</strong>
        log.debug("signed: payment={}, signature={}", payment, signature);
        return signature;
    }
}</pre>
                </div>

                <div class="tab-pane" id="b64Signer">

                    <p>Because you don't usually work directly with byte arrays, but rather with a base64 encoded
                        version of such data, there is also a base64 version of the signer.</p>
                    
<pre class="prettyprint"><strong>&lt;crypt:b64Signer id="signer" privateKey-ref="privateKey"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;crypt:privateKey id="privateKey" keystore-ref="keystore" alias="test"
    password="password"/&gt;

&lt;crypt:keystore id="keystore" location="classpath:keystore.jks"
    password="password"/&gt;
</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">algorithm</h4>
                        <code>SHA1withRSA</code> is the default algorithm and can be omitted.
                    </div>

                    <p>And this is how you use it:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.Base64EncodedSigner;</strong>

public class MyBase64PaymentSigner {

    <strong>@Autowired
    private Base64EncodedSigner signer;</strong>

    public void makePayment(String clientName) {
        String messageToBeTrusted = "Please pay 250 euro to " + clientName;
        <strong>String b64signature = signer.sign(messageToBeTrusted);</strong>
    }
}</pre>
                </div>

                <div class="tab-pane" id="verifier">
                    <p>A simple verifier is useful when you need to verify something with a single public key.</p>

<pre class="prettyprint"><strong>&lt;crypt:verifier id="verifier" publicKey-ref="publicKey" algorithm="SHA1withRSA"/&gt;</strong>

&lt;crypt:publicKey id="publicKey" keystore-ref="keystore" alias="test"/&gt;

&lt;crypt:keystore id="keystore" location="classpath:keystore.jks"
    password="password"/&gt;
</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">algorithm</h4>
                        <code>SHA1withRSA</code> is the default algorithm and can be omitted.
                    </div>

                    <p>Here is an example usage of the verifier:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.Verifier;</strong>

public class MyPaymentVerifier {

    <strong>@Autowired
    private Verifier verifier;</strong>

    public void process(byte[] payment, byte[] signature) {
        if (<strong>verifier.verify(payment, signature)</strong>) {
            proceed(payment);
        } else {
            callTheCops("I have a bad feeling about this.");
        }
    }
}</pre>
                </div>

                <div class="tab-pane" id="b64Verifier">

                    <p>Because you don't usually work directly with byte arrays, but rather with a base64 encoded
                        version of such data, there is also a base64 version of the signer.</p>

<pre class="prettyprint"><strong>&lt;crypt:b64Verifier id="verifier" publicKey-ref="publicKey"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;crypt:publicKey id="publicKey" keystore-ref="keystore" alias="test"/&gt;

&lt;crypt:keystore id="keystore" location="classpath:keystore.jks"
    password="password"/&gt;
</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">algorithm</h4>
                        <code>SHA1withRSA</code> is the default algorithm and can be omitted.
                    </div>

                    <p>Here is an example usage of the base64 verifier:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.Base64EncodedVerifier;</strong>

public class VaderVerifier {

    <strong>@Autowired
    private Base64EncodedVerifier verifier;</strong>

    public void process(String b64signature) {
        String statement = "I am your father";

        if (<strong>verifier.verify(statement, b64signature)</strong>) {
            scream("Nooooooo!");
        } else {
            log("You are not the father I'm looking for.");
        }
    }
}</pre>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="signatureMulti">
    <div class="page-header">
        <h1>Signature
            <small>with Multiple Keys</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Digital Signatures with Multiple Keys</h3>

            <p>If you need to switch keys when signing or verifying, use one of these.</p>
        </div>

        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#signerWithChooserByPrivateKeyId" data-toggle="tab">signerWithChooserByPrivateKeyId</a></li>
                <li><a href="#b64SignerWithChooserByPrivateKeyId" data-toggle="tab">b64SignerWithChooserByPrivateKeyId</a></li>
                <li><a href="#verifierWithChooserByPublicKeyId" data-toggle="tab">verifierWithChooserByPublicKeyId</a></li>
                <li><a href="#b64VerifierWithChooserByPublicKeyId" data-toggle="tab">b64VerifierWithChooserByPublicKeyId</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="signerWithChooserByPrivateKeyId">

                    <p>Sometimes you need to be able to select signing keys at runtime. This is how you do it.</p>

<pre class="prettyprint"><strong>&lt;crypt:signerWithChooserByPrivateKeyId id="signer" privateKeyMap-ref="privateKeyMap"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;util:map id="privateKeyMap"&gt;
    &lt;entry key="mcDonalds"&gt;
        &lt;crypt:privateKey keystore-ref="mcDonaldsKeystore" alias="ronald"
            password="ketchup"/&gt;
    &lt;/entry&gt;
    &lt;entry key="burgerKing"&gt;
        &lt;crypt:privateKey keystore-ref="burgerKingKeystore" alias="cowboy"
            password="meatIsMurder"/&gt;
    &lt;/entry&gt;
&lt;/util:map&gt;

&lt;crypt:keystore id="mcDonaldsKeystore" location="classpath:keystore-mcdonalds.jks"
    password="royaleWithCheese"/&gt;

&lt;crypt:keystore id="burgerKingKeystore" location="classpath:keystore-burger-king.jks"
    password="r0naldSucksStinkyMeat"/&gt;
</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">algorithm</h4>
                        <code>SHA1withRSA</code> is the default algorithm and can be omitted.
                    </div>

                    <p>The signer can then be used like this:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.SignerWithChooserByPrivateKeyId;</strong>

public class MyBusinessSigner {

    <strong>@Autowired
    private SignerWithChooserByPrivateKeyId signer;</strong>

    public void myBusinessMethod(byte[] messageToBeTrusted) {
        byte[] mcsignature = signer.sign("mcDonalds", messageToBeTrusted);
        byte[] bksignature = signer.sign("burgerKing", messageToBeTrusted);
    }
}</pre>
                </div>

                <div class="tab-pane" id="b64SignerWithChooserByPrivateKeyId">

                    <p>Because you don't usually work directly with byte arrays, but rather with a base64 encoded
                        version of such data, there also is a base64 version of the signer.</p>

<pre class="prettyprint"><strong>&lt;crypt:b64SignerWithChooserByPrivateKeyId id="signer" privateKeyMap-ref="privateKeyMap"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;util:map id="privateKeyMap"&gt;
    &lt;entry key="mcDonalds"&gt;
        &lt;crypt:privateKey keystore-ref="mcDonaldsKeystore" alias="ronald"
            password="ketchup"/&gt;
    &lt;/entry&gt;
    &lt;entry key="burgerKing"&gt;
        &lt;crypt:privateKey keystore-ref="burgerKingKeystore" alias="cowboy"
            password="meatIsMurder"/&gt;
    &lt;/entry&gt;
&lt;/util:map&gt;

&lt;crypt:keystore id="mcDonaldsKeystore" location="classpath:keystore-mcdonalds.jks"
    password="royaleWithCheese"/&gt;

&lt;crypt:keystore id="burgerKingKeystore" location="classpath:keystore-burger-king.jks"
    password="r0naldSucksStinkyMeat"/&gt;
</pre>

                    <div class="alert alert-info">
                        <h4 class="alert-heading">algorithm</h4>
                        <code>SHA1withRSA</code> is the default algorithm and can be omitted.
                    </div>

                    <p>The signer can then be used like this:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.Base64EncodedSignerWithChooserByPrivateKeyId;</strong>

public class MyBusinessSigner {

    <strong>@Autowired
    private Base64EncodedSignerWithChooserByPrivateKeyId signer;</strong>

    public void myBusinessMethod(String messageToBeTrusted) {
        String b64MCsignature = signer.sign("mcDonalds", messageToBeTrusted);
        String b64BKsignature = signer.sign("burgerKing", messageToBeTrusted);
    }
}</pre>
                </div>

                <div class="tab-pane" id="verifierWithChooserByPublicKeyId">

                    <p>Sometimes you need to be able to select verifying keys at runtime. This is how you do it.</p>

<pre class="prettyprint"><strong>&lt;crypt:verifierWithChooserByPublicKeyId id="verifier" publicKeyMap-ref="publicKeyMap"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;util:map id="publicKeyMap"&gt;
    &lt;entry key="mcDonalds"&gt;
        &lt;crypt:publicKey keystore-ref="mcDonaldsKeystore" alias="ronald"/&gt;
    &lt;/entry&gt;
    &lt;entry key="burgerKing"&gt;
        &lt;crypt:publicKey keystore-ref="burgerKingKeystore" alias="cowboy"/&gt;
    &lt;/entry&gt;
&lt;/util:map&gt;

&lt;crypt:keystore id="mcDonaldsKeystore" location="classpath:keystore-mcdonalds.jks"
    password="royaleWithCheese"/&gt;

&lt;crypt:keystore id="burgerKingKeystore" location="classpath:keystore-burger-king.jks"
    password="r0naldSucksStinkyMeat"/&gt;
</pre>

                    <p>Here is an example usage of the verifier:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.VerifierWithChooserByPublicKeyId;</strong>

public class MyBusinessVerifier {

    @Autowired
    <strong>private VerifierWithChooserByPublicKeyId verifier;</strong>

    public void myBusinessMethod(byte[] messageToBeTrusted, byte[] signature) {
        <strong>boolean verified = verifier.verify("mcDonalds", messageToBeTrusted, signature);</strong>
    }
}
</pre>
                </div>

                <div class="tab-pane" id="b64VerifierWithChooserByPublicKeyId">

                    <p>Because you don't usually work directly with byte arrays, but rather with a base64 encoded
                        version of such data, there also is a base64 version of the verifier.</p>

<pre class="prettyprint"><strong>&lt;crypt:b64VerifierWithChooserByPublicKeyId id="verifier" publicKeyMap-ref="publicKeyMap"
    algorithm="SHA1withRSA"/&gt;</strong>

&lt;util:map id="publicKeyMap"&gt;
    &lt;entry key="mcDonalds"&gt;
        &lt;crypt:publicKey keystore-ref="mcDonaldsKeystore" alias="ronald"/&gt;
    &lt;/entry&gt;
    &lt;entry key="burgerKing"&gt;
        &lt;crypt:publicKey keystore-ref="burgerKingKeystore" alias="cowboy"/&gt;
    &lt;/entry&gt;
&lt;/util:map&gt;

&lt;crypt:keystore id="mcDonaldsKeystore" location="classpath:keystore-mcdonalds.jks"
    password="royaleWithCheese"/&gt;

&lt;crypt:keystore id="burgerKingKeystore" location="classpath:keystore-burger-king.jks"
    password="r0naldSucksStinkyMeat"/&gt;
</pre>

                    <p>Here is an example usage of the verifier:</p>

<pre class="prettyprint">
<strong>import com.google.code.springcryptoutils.core.signature.Base64EncodedVerifierWithChooserByPublicKeyId;</strong>

public class MyBusinessVerifier {

    @Autowired
    <strong>private Base64EncodedVerifierWithChooserByPublicKeyId verifier;</strong>

    public void myBusinessMethod(String message, String b64signature) {
        if (<strong>verifier.verify("mcDonalds", message, b64signature)</strong>) {
            proceedWithOrder(message);
        } else {
            // ignore order
        }
    }
}
</pre>
                </div>

            </div>
        </div>
    </div>
</section>

<section id="symmetric">
    <div class="page-header">
        <h1>Symmetric Encryption
            <small>Fast and furious</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Symmetric Encryption</h3>

            <p>Symmetric Encryption employs a shared secret in order to exchange messages securely.</p>
        </div>

        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#symmetricKeyGenerator" data-toggle="tab">symmetricKeyGenerator</a></li>
                <li><a href="#b64SymmetricKeyGenerator" data-toggle="tab">b64SymmetricKeyGenerator</a></li>
                <li><a href="#symmetricCipherer" data-toggle="tab">symmetricCipherer</a></li>
                <li><a href="#b64SymmetricCipherer" data-toggle="tab">b64SymmetricCipherer</a></li>
                <li><a href="#symmetricCiphererWithStaticKey" data-toggle="tab">symmetricCiphererWithStaticKey</a></li>
                <li><a href="#b64SymmetricCiphererWithStaticKey" data-toggle="tab">b64SymmetricCiphererWithStaticKey</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="symmetricKeyGenerator">
                    TODO
                </div>
                <div class="tab-pane" id="b64SymmetricKeyGenerator">
                    TODO
                </div>
                <div class="tab-pane" id="symmetricCipherer">
                    TODO
                </div>
                <div class="tab-pane" id="b64SymmetricCipherer">
                    TODO
                </div>
                <div class="tab-pane" id="symmetricCiphererWithStaticKey">
                    TODO
                </div>
                <div class="tab-pane" id="b64SymmetricCiphererWithStaticKey">
                    TODO
                </div>
            </div>
        </div>
    </div>
</section>

<section id="asymmetric">
    <div class="page-header">
        <h1>Asymmetric Encryption
            <small>Slow Trane</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Asymmetric Encryption</h3>

            <p>Asymmetric Encryption employs key couples in order to exchange messages securely.</p>
        </div>

        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#asymmetricCipherer" data-toggle="tab">asymmetricCipherer</a></li>
                <li><a href="#b64AsymmetricCipherer" data-toggle="tab">b64AsymmetricCipherer</a></li>
                <li><a href="#symmetricCipherer" data-toggle="tab">asymmetricCiphererWithChooserByKeyId</a></li>
                <li><a href="#b64AsymmetricCiphererWithChooserByKeyId" data-toggle="tab">b64AsymmetricCiphererWithChooserByKeyId</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="asymmetricCipherer">
                    TODO
                </div>
                <div class="tab-pane" id="b64AsymmetricCipherer">
                    TODO
                </div>
                <div class="tab-pane" id="asymmetricCiphererWithChooserByKeyId">
                    TODO
                </div>
                <div class="tab-pane" id="b64AsymmetricCiphererWithChooserByKeyId">
                    TODO
                </div>
            </div>
        </div>
    </div>
</section>

<section id="digest">
    <div class="page-header">
        <h1>Message Digests
            <small>Hmm... more yummy bytes, please?</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Message Digests</h3>
        </div>

        <div class="span9 columns">
            <h2>TODO</h2>
        </div>
    </div>
</section>

<section id="messageAuthenticationCodes">
    <div class="page-header">
        <h1>Message Authentication Codes
            <small>Trust me on this one</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>Message Authentication Codes</h3>

            <p>In God we trust. All others must submit an X.509 certificate.</p>
        </div>

        <div class="span9 columns">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#mac" data-toggle="tab">mac</a></li>
                <li><a href="#b64Mac" data-toggle="tab">b64Mac</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="mac">
                    TODO
                </div>
                <div class="tab-pane" id="b64Mac">
                    TODO
                </div>
            </div>
        </div>
    </div>
</section>

<section id="changelog">
    <div class="page-header">
        <h1>ChangeLog
            <small>The sources, they are a changin'</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>ChangeLog</h3>

            <p>This is what happens between releases.</p>
        </div>

        <div class="span9 columns">
            <h2>release 1.1.1 - (2012-02-02)</h2>

            <ul>
                <li>spring crypto utils is now in
                    <a href="http://repo1.maven.org/maven2/com/google/code/spring-crypto-utils/spring-crypto-utils/">maven
                        central</a>, so there's no extra repository to setup in the pom.

                    If you had previously setup our custom repository, you can safely remove it from your poms now as
                    all previous versions have also been uploaded to central. There are no source code changes in
                    this release.</li>
            </ul>

            <h2>release 1.1.0 - (2012-01-29)</h2>

            <ul>
                <li>fix: non-existant alias name should throw an error</li>
                <li>new: added crypt:secretKey element</li>
                <li>new: added support for mac (message authentication codes)</li>
            </ul>

            <h2>release 1.0.1 - (2012-01-25)</h2>

            <ul>
                <li>new: added support for configuring a keystore using conventional java system properties
                    <code>javax.net.ssl.keyStore</code> and <code>javax.net.ssl.keyStorePassword</code> throgh the
                    <code>&lt;crypt:defaultKeystore/&gt;</code> configuration element</li>
            </ul>

            <h2>release 1.0.0 - (2011-09-15)</h2>

            <ul>
                <li>first public stable release</li>
            </ul>
        </div>
    </div>
</section>

<section id="roadmap">
    <div class="page-header">
        <h1>RoadMap
            <small>What's the future bringing us?</small>
        </h1>
    </div>

    <div class="row">
        <div class="span3 columns">
            <h3>RoadMap</h3>

            <p>This is a list of what's actually done and what needs to be done. Pull requests welcome!</p>
        </div>

        <div class="span9 columns">
            <h2>Implemented</h2>

            <ul>
                <li>configuration of keystores</li>
                <li>configuration of public and private keys</li>
                <li>selection at runtime of the keys to use</li>
                <li>configuration of signers and verifiers</li>
                <li>configuration of symmetric key cipherers</li>
                <li>configuration of asymmetric key cipherers</li>
                <li>configuration of message digesters (md5, sha1, etc)</li>
                <li>configuration of mac (message authentication codes) digesters</li>
                <li>base64 versions for all of the above</li>
                <li>javadoc for all classes</li>
                <li>complete documentation of all features</li>
            </ul>

            <h2>Wish List</h2>

            <ul>
                <li>configuration with annotations and Spring 3.1 JavaConfig style</li>
                <li>pkcs#7 signatures</li>
            </ul>
        </div>
    </div>
</section>

<hr>

<footer><p> &copy; <a href="https://twitter.com/#!/mirkocaserta">Mirko
    Caserta</a> 2012. Licensed under the Apache License, Version 2.0. The Spring
    Framework is &copy; SpringSource. </p></footer>

</div>

<script src="js/jquery.js" type="text/javascript"></script>
<script src="js/prettify.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>
<script src="js/application.js" type="text/javascript"></script>

</body>
</html>
